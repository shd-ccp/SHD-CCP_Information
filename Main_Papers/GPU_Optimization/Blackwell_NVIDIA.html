<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Blackwell Block | SHD-CCP Hardware Spec</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@300;400;700&family=Inter:wght@400;600;800&display=swap');

        :root {
            --neon-green: #0aff60;
            --bg-dark: #020617;
            --panel-bg: #0f172a;
        }

        body {
            background-color: var(--bg-dark);
            color: #e2e8f0;
            font-family: 'Inter', sans-serif;
            overflow-x: hidden;
        }

        .mono { font-family: 'JetBrains Mono', monospace; }

        /* Card Styling */
        .glass-panel {
            background: rgba(15, 23, 42, 0.8);
            border: 1px solid #334155;
            backdrop-filter: blur(12px);
            border-radius: 12px;
            padding: 2rem;
            margin-bottom: 2rem;
        }

        h1 { font-size: 2.5rem; font-weight: 800; color: #fff; margin-bottom: 1rem; }
        h2 { font-size: 1.8rem; color: #34d399; font-weight: 700; margin-top: 2rem; margin-bottom: 1rem; border-bottom: 1px solid #334155; padding-bottom: 0.5rem; }
        h3 { font-size: 1.2rem; color: #a7f3d0; font-weight: 600; margin-top: 1.5rem; margin-bottom: 0.5rem; }
        
        .code-block {
            background: #0f172a;
            border: 1px solid #334155;
            border-radius: 6px;
            padding: 1rem;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.85rem;
            color: #a7f3d0;
            overflow-x: auto;
            margin: 1rem 0;
        }

        /* Flowchart */
        .flow-container {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 1rem;
            margin: 2rem 0;
            padding: 1rem;
            background: rgba(0,0,0,0.3);
            border-radius: 8px;
        }
        .flow-node {
            background: #1e293b;
            border: 1px solid #475569;
            padding: 1rem;
            border-radius: 6px;
            text-align: center;
            flex: 1;
        }
        .flow-arrow { color: #64748b; font-size: 1.2rem; }

        /* Maturity Model */
        .maturity-bar {
            display: flex;
            height: 40px;
            border-radius: 20px;
            overflow: hidden;
            margin: 2rem 0;
            background: #1e293b;
        }
        .maturity-step {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.75rem;
            font-weight: bold;
            color: #0f172a;
            transition: all 0.3s;
        }
        .step-1 { background: #94a3b8; }
        .step-2 { background: #64748b; }
        .step-3 { background: #475569; }
        .step-4 { background: #334155; color: #fff; }
        .step-5 { background: #34d399; color: #000; box-shadow: 0 0 20px #34d399; z-index: 10; transform: scale(1.05); }

    </style>
</head>
<body class="p-4 md:p-12">

    <main class="max-w-5xl mx-auto">
        
        <header class="text-center mb-16 pt-8">
            <div class="inline-block px-3 py-1 mb-4 border border-green-500/30 rounded-full text-xs font-mono text-green-400 bg-green-900/20">NVIDIA BLACKWELL (SM100) SPECIFICATION</div>
            <h1>The Blackwell Block</h1>
            <p class="text-xl text-slate-400">Re-Architecting the Einstein Tile for the 5-Mode TMEM Pipeline</p>
        </header>

        <!-- SECTION 1: EXECUTIVE SUMMARY -->
        <section class="glass-panel">
            <h2>1. The Architectural Discontinuity</h2>
            <p class="text-slate-300 mb-4">
                The transition from Hopper (H100) to Blackwell (B200) represents a fundamental shift. The "Einstein Tile"—optimized for register accumulation—hits a scaling wall due to register pressure.
            </p>
            <p class="text-slate-300 mb-4">
                <strong>The Solution:</strong> The <strong>Blackwell Block</strong>. This new primitive decouples the accumulator from the Register File and places it into <strong>TMEM (Tensor Memory)</strong>—a dedicated 256KB/SM on-chip structure.
            </p>
            
            <div class="flow-container">
                <div class="flow-node">
                    <div class="text-xs text-slate-500">LEGACY (HOPPER)</div>
                    <div class="font-bold text-white">Registers</div>
                    <div class="text-[10px] text-red-400">Bottleneck (Spilling)</div>
                </div>
                <i class="fas fa-arrow-right flow-arrow"></i>
                <div class="flow-node border-green-500 bg-green-900/10">
                    <div class="text-xs text-green-400">NEW (BLACKWELL)</div>
                    <div class="font-bold text-white">TMEM</div>
                    <div class="text-[10px] text-green-300">256KB Dedicated</div>
                </div>
            </div>
        </section>

        <!-- SECTION 2: BLACKWELL BLOCK SPECIFICATION -->
        <section class="glass-panel">
            <h2>2. The Blackwell Block Specification</h2>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <div>
                    <h3>2.1 Logical Dimensions</h3>
                    <ul class="list-disc pl-5 space-y-2 text-sm text-slate-300">
                        <li><strong>Standard Block:</strong> 128 x 256 x 16 (M x N x K).</li>
                        <li><strong>Accumulator:</strong> FP32 residence in TMEM (128KB).</li>
                        <li><strong>Throughput:</strong> 4x larger tiles per clock via FP4.</li>
                    </ul>
                </div>
                <div>
                    <h3>2.2 Memory Residency Map</h3>
                    <ul class="space-y-2 text-xs font-mono">
                        <li class="p-2 bg-slate-800 rounded flex justify-between">
                            <span>Global Weights</span> <span class="text-purple-400">HBM3e (TMA Copy)</span>
                        </li>
                        <li class="p-2 bg-slate-800 rounded flex justify-between">
                            <span>Operands (A/B)</span> <span class="text-blue-400">SMEM (L1 Cache)</span>
                        </li>
                        <li class="p-2 bg-slate-800 rounded flex justify-between border border-green-500">
                            <span>Accumulator (C)</span> <span class="text-green-400">TMEM (Tensor Mem)</span>
                        </li>
                        <li class="p-2 bg-slate-800 rounded flex justify-between">
                            <span>Epilogue</span> <span class="text-yellow-400">Registers (ALU)</span>
                        </li>
                    </ul>
                </div>
            </div>

            <div class="mt-8">
                <h3>2.3 The tcgen05 State Machine</h3>
                <div class="code-block">
// Pseudo-ASM for Blackwell Block Pipeline
1. ALLOC:  tcgen05.alloc [TMEM_PTR], 128KB
2. FETCH:  cp.async.bulk.tensor [SMEM] <- [HBM]
3. COMPUTE: tcgen05.mma [TMEM_PTR], [SMEM_A], [SMEM_B]
4. COMMIT: tcgen05.commit
5. WAIT:   tcgen05.wait
6. LOAD:   tcgen05.ld [REG] <- [TMEM_PTR] (Epilogue)
7. DEALLOC: tcgen05.dealloc
                </div>
            </div>
        </section>

        <!-- SECTION 3: THE 5 KERNEL MODES -->
        <section class="glass-panel">
            <h2>3. The 5 Kernel Maturity Modes</h2>
            <p class="text-slate-300 text-sm mb-6">Transitioning from legacy code to peak Blackwell performance.</p>

            <div class="maturity-bar">
                <div class="step-1">1. NAIVE</div>
                <div class="step-2">2. ASYNC</div>
                <div class="step-3">3. FP4</div>
                <div class="step-4">4. CLUSTER</div>
                <div class="step-5">5. PINNACLE</div>
            </div>

            <div class="space-y-4 text-sm text-slate-300">
                <details class="bg-slate-900/50 p-4 rounded border border-slate-700">
                    <summary class="cursor-pointer font-bold text-white hover:text-green-400">Mode 3: The FP4 Precision Block (Neural Collapse)</summary>
                    <div class="mt-2 pl-4 border-l-2 border-green-500">
                        <p>Utilizes <strong>e2m1 (FP4)</strong> format with Block Scaling. Essential for "Neural Collapse" workloads where gradients align with Hessian eigenvectors, allowing 4x throughput.</p>
                    </div>
                </details>

                <details class="bg-slate-900/50 p-4 rounded border border-slate-700">
                    <summary class="cursor-pointer font-bold text-white hover:text-green-400">Mode 5: The Blackwell Pinnacle (Multicast)</summary>
                    <div class="mt-2 pl-4 border-l-2 border-green-500">
                        <p><strong>2xSM Cooperative MMA:</strong> Two SMs share a single logical tile. <strong>TMA Multicast</strong> broadcasts weights to both SMs simultaneously, halving HBM bandwidth usage. This is the ultimate optimization for Clifford Torus rotations.</p>
                    </div>
                </details>
            </div>
        </section>

        <!-- SECTION 4: IMPLEMENTATION (CuTe) -->
        <section class="glass-panel">
            <h2>4. Implementation Strategy: CuTe Layouts</h2>
            <p class="text-slate-300 mb-4">Blackwell requires <strong>Z-Order (Morton)</strong> swizzling to avoid TMEM bank conflicts.</p>

            <div class="code-block">
using namespace cute;

// 1. Define TMEM Layout (Swizzled for SM100)
using TmemLayout = Layout<Shape<_128, _256>, Stride<_256, _1>>;

// 2. Define Copy Atom (Blackwell Specific)
using TmemCopyAtom = SM100_TMEM_LOAD_32dp32b1x;

// 3. Create Loader
auto tmem_loader = make_tmem_copy(TmemCopyAtom{}, tmem_tensor);

// 4. Epilogue Fusion (TMEM -> Regs -> Global)
copy(tmem_loader, tmem_tensor, register_tensor);
            </div>
            
            <div class="mt-4 p-4 bg-yellow-900/20 border border-yellow-500/30 rounded text-sm text-yellow-200">
                <strong>Critical Warning:</strong> The Epilogue must fuse the non-linear activation (XOR/Sigmoid) immediately after `tcgen05.ld`. Writing intermediate results to global memory destroys the bandwidth advantage.
            </div>
        </section>

    </main>

    <footer class="text-center pb-12 text-slate-600 text-xs">
        SHD-CCP HARDWARE ENGINEERING GROUP // 2026
    </footer>

</body>
</html>
